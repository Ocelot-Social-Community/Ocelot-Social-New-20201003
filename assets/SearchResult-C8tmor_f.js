import{u as $,g as te,h as se,i as G,j as ae,P as le,t as re,k as ue,l as T,m as C,n as ne,w as N,p as s,q as ie,R as I,v as oe,x as ce,y as pe,C as ve,z as he,A as de,B as me,D as ye,E as ge,F as be,G as we,H as P,I as U,J as ke,K as q,L as fe}from"./app-Blg-8n75.js";const He=["/CHANGELOG.html","/CODE_OF_CONDUCT.html","/CONTRIBUTING.html","/LICENSE.html","/","/SUMMARY.html","/documentation.html","/testing.html","/backend/","/backend/graphql.html","/backend/neo4j-graphql-js.html","/backend/testing.html","/cypress/","/cypress/features.html","/deployment/DOCKER_MORE_CLOSELY.html","/deployment/Minikube.html","/deployment/","/deployment/TODO-next-update.html","/deployment/deployment-values.html","/deployment/deployment.html","/frontend/","/neo4j/","/webapp/","/webapp/components.html","/webapp/html.html","/webapp/scss.html","/webapp/testing.html","/webapp/vue.html","/webapp/maintenance/","/backend/src/graphql/GraphQL-Playground.html","/deployment/src/kubernetes/Backup.html","/deployment/src/kubernetes/DigitalOcean.html","/deployment/src/kubernetes/","/webapp/components/Category/","/webapp/components/DateTime/","/webapp/components/Logo/demo.html","/webapp/static/img/mapbox/marker-icons/","/404.html","/backend/src/graphql/","/backend/src/","/deployment/src/","/webapp/components/","/webapp/components/Logo/","/webapp/static/img/mapbox/","/webapp/static/img/","/webapp/static/"],Re="SEARCH_PRO_QUERY_HISTORY",g=$(Re,[]),Ce=()=>{const{queryHistoryCount:a}=q,l=a>0;return{enabled:l,queryHistory:g,addQueryHistory:r=>{l&&(g.value=Array.from(new Set([r,...g.value.slice(0,a-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},A=a=>He[a.id]+("anchor"in a?`#${a.anchor}`:""),qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:M}=q,b=$(qe,[]),xe=()=>{const a=M>0;return{enabled:a,resultHistory:b,addResultHistory:l=>{if(a){const r={link:A(l),display:l.display};"header"in l&&(r.header=l.header),b.value=[r,...b.value.slice(0,M-1)]}},removeResultHistory:l=>{b.value=[...b.value.slice(0,l),...b.value.slice(l+1)]}}},Le=a=>{const l=ve(),r=G(),x=he(),n=T(0),f=C(()=>n.value>0),d=de([]);return me(()=>{const{search:m,terminate:L}=ye(),w=ke(c=>{const k=c.join(" "),{searchFilter:Q=h=>h,splitWord:O,suggestionsFilter:_,...y}=l.value;k?(n.value+=1,m(c.join(" "),r.value,y).then(h=>Q(h,k,r.value,x.value)).then(h=>{n.value-=1,d.value=h}).catch(h=>{console.warn(h),n.value-=1,n.value||(d.value=[])})):d.value=[]},q.searchDelay-q.suggestDelay);N([a,r],([c])=>w(c),{immediate:!0}),ge(()=>{L()})}),{isSearching:f,results:d}};var Oe=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=se(),x=G(),n=ae(le),{enabled:f,addQueryHistory:d,queryHistory:m,removeQueryHistory:L}=Ce(),{enabled:w,resultHistory:c,addResultHistory:k,removeResultHistory:Q}=xe(),O=f||w,_=re(a,"queries"),{results:y,isSearching:h}=Le(_),u=ue({isQuery:!0,index:0}),p=T(0),v=T(0),j=C(()=>O&&(m.value.length>0||c.value.length>0)),D=C(()=>y.value.length>0),S=C(()=>y.value[p.value]||null),Y=()=>{const{isQuery:e,index:t}=u;t===0?(u.isQuery=!e,u.index=e?c.value.length-1:m.value.length-1):u.index=t-1},B=()=>{const{isQuery:e,index:t}=u;t===(e?m.value.length-1:c.value.length-1)?(u.isQuery=!e,u.index=0):u.index=t+1},K=()=>{p.value=p.value>0?p.value-1:y.value.length-1,v.value=S.value.contents.length-1},z=()=>{p.value=p.value<y.value.length-1?p.value+1:0,v.value=0},J=()=>{v.value<S.value.contents.length-1?v.value+=1:z()},V=()=>{v.value>0?v.value-=1:K()},E=e=>e.map(t=>fe(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=be[e.index]||"$content",[i,R=""]=we(t)?t[x.value].split("$content"):t.split("$content");return e.display.map(o=>s("div",E([i,...o,R])))}return e.display.map(t=>s("div",E(t)))},H=()=>{p.value=0,v.value=0,l("updateQuery",""),l("close")},X=()=>f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},n.value.queryHistory),m.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===t}],onClick:()=>{l("updateQuery",e)}},[s(P,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:U,onClick:i=>{i.preventDefault(),i.stopPropagation(),L(t)}})]))])):null,Z=()=>w?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},n.value.resultHistory),c.value.map((e,t)=>s(I,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===t}],onClick:()=>{H()}},()=>[s(P,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(i=>E(i)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:U,onClick:i=>{i.preventDefault(),i.stopPropagation(),Q(t)}})]))])):null;return ne("keydown",e=>{if(a.isFocusing){if(D.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const t=S.value.contents[v.value];d(a.queries.join(" ")),k(t),r.push(A(t)),H()}}else if(w){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")B();else if(e.key==="Enter"){const{index:t}=u;u.isQuery?(l("updateQuery",m.value[t]),e.preventDefault()):(r.push(c.value[t].link),H())}}}}),N([p,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!D.value:!j.value}],id:"search-pro-results"},a.queries.length?h.value?s(ie,{hint:n.value.searching}):D.value?s("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:t},i)=>{const R=p.value===i;return s("li",{class:["search-pro-result-list-item",{active:R}]},[s("div",{class:"search-pro-result-title"},e||n.value.defaultTitle),t.map((o,ee)=>{const F=R&&v.value===ee;return s(I,{to:A(o),class:["search-pro-result-item",{active:F,"aria-selected":F}],onClick:()=>{d(a.queries.join(" ")),k(o),H()}},()=>[o.type==="text"?null:s(o.type==="title"?oe:o.type==="heading"?ce:pe,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?s("div",{class:"content-header"},o.header):null,s("div",W(o))])])})])})):n.value.emptyResult:O?j.value?[X(),Z()]:n.value.emptyHistory:n.value.emptyResult)}});export{Oe as default};
